# AGENTS.md

本文件是后续 AI/Agent 改动本仓库时的执行约定。

## 目标

- 维持“无 build、可直接打开运行”的项目形态。
- 维持“运营配置与引擎解耦”的边界。
- 优先小步快改，避免一次性大重写。

## 目录职责（必须遵守）

- `app/`: 仅页面与样式（入口 `app/index.html`）
- `config/`: 仅配置数据（运营可改）
- `src/`: 仅引擎逻辑（开发可改）
- `docs/`: 说明文档

不要把引擎逻辑写回 `config/` 或 `app/`，不要把配置硬编码回 `src/`。

## 修改优先级

1. 先改配置，再考虑改引擎。
2. 若需求能通过 `config/game-config.js` 完成，不动 `src/game-engine.js`。
3. 若必须改引擎，保持对现有配置向后兼容。

## 配置设计约束

- 配置使用声明式结构（condition/effects），不要在配置里引入函数。
- 新增字段时，先给默认值并做兜底，避免旧配置崩溃。
- 运营常改项必须有清晰注释或在 `docs/运营配置说明.md` 记录。

## 代码风格

- 使用原生 ES 语法，避免引入打包器依赖。
- 命名清晰、单一职责，避免巨大函数持续膨胀。
- 仅在必要处加注释，注释解释“为什么”，不复述“做了什么”。

## 验证要求

每次改动后至少执行：

1. `bash scripts/check.sh` - 运行完整检查（ESLint、JSON验证、冒烟测试、单元测试）
2. 手动验证 `app/index.html` 可打开，核心流程可跑通（开局 -> 修炼 -> 结算）

**注意**：每次大批量修改后必须运行 `scripts/check.sh`，确保代码质量和测试通过。

## 禁止事项

- 不要引入 build 流程（webpack/vite 等）作为默认运行方式。
- 不要把版本号塞进页面文件名（保持 `app/index.html`）。
- 不要在未说明的情况下重置或删除用户配置内容。

